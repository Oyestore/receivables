# Module 09 - Production Deployment Configuration
# Phase 9.5 Complete - Growth Catalyst Infrastructure

# ============================================================================
# ENVIRONMENT VARIABLES
# ============================================================================

# Module 09 Service
NODE_ENV=production
PORT=3009
SERVICE_NAME=module-09-marketing-customer-success

# Database
DATABASE_URL=postgresql://user:password@localhost:5432/module_09_prod
DATABASE_POOL_SIZE=20
DATABASE_SSL=true

# Redis (for caching network intelligence benchmarks)
REDIS_URL=redis://localhost:6379
REDIS_TTL=3600  # 1 hour cache for benchmarks

# Event Bus
EVENT_BUS_TYPE=kafka
KAFKA_BROKERS=kafka-1:9092,kafka-2:9092,kafka-3:9092
KAFKA_TOPIC_PREFIX=prod_platform

# ============================================================================
# NETWORK INTELLIGENCE CONFIGURATION
# ============================================================================

NETWORK_INTEL_ENABLED=true
NETWORK_INTEL_ANONYMIZATION=true
NETWORK_INTEL_MIN_SAMPLE_SIZE=100
NETWORK_INTEL_BENCHMARK_TTL=86400  # 24 hours

# ML Model Configuration
ML_MODEL_ENDPOINT=http://ml-service:8000
ML_MODEL_TIMEOUT=5000  # 5 seconds
ML_MODEL_RETRY_COUNT=3

# Model Retraining Schedule
ML_RETRAIN_SCHEDULE=0 0 * * 0  # Every Sunday at midnight
ML_RETRAIN_MIN_SAMPLES=10000
ML_DEPLOY_ACCURACY_THRESHOLD=75

# ============================================================================
# VIRAL WORKFLOW CONFIGURATION
# ============================================================================

VIRAL_WORKFLOWS_ENABLED=true
VIRAL_WORKFLOW_COOLDOWN=604800000  # 7 days in milliseconds
VIRAL_UI_AUTO_SHOW=true
VIRAL_UI_POSITION=toast

# Viral Scoring Thresholds
VIRAL_SCORE_HIGH_THRESHOLD=80
VIRAL_SCORE_MEDIUM_THRESHOLD=50

# Social Proof Configuration
VIRAL_SOCIAL_PROOF_ENABLED=true
VIRAL_MIN_INVITE_COUNT=100  # Minimum invites before showing social proof

# ============================================================================
# COMMUNITY INTELLIGENCE CONFIGURATION
# ============================================================================

COMMUNITY_ENABLED=true
COMMUNITY_AI_SUMMARIES=true
COMMUNITY_AI_MODEL=deepseek-r1
COMMUNITY_MODERATION=auto

# Template Marketplace
TEMPLATE_CERTIFICATION_ENABLED=true
TEMPLATE_MIN_DOWNLOADS_FOR_CERTIFICATION=50
TEMPLATE_MIN_RATING_FOR_CERTIFICATION=4.5

# Expert Network
EXPERT_MIN_CONTRIBUTION_SCORE=500
EXPERT_BADGE_SYSTEM_ENABLED=true

# ============================================================================
# REFERRAL ENGINE 2.0 CONFIGURATION
# ============================================================================

REFERRAL_ENGINE_ENABLED=true
REFERRAL_BASE_REWARD=500
REFERRAL_CURRENCY=INR

# Tier Thresholds
REFERRAL_AMBASSADOR_THRESHOLD=10
REFERRAL_ENTERPRISE_THRESHOLD=50

# Dynamic Incentive Bonuses
REFERRAL_LTV_BONUS=500
REFERRAL_ENTERPRISE_BONUS=2000
REFERRAL_INDUSTRY_MATCH_BONUS=300
REFERRAL_URGENCY_BONUS=700
REFERRAL_COMPETITIVE_BONUS=1000

# AI Suggestions
REFERRAL_AI_SUGGESTIONS_ENABLED=true
REFERRAL_AI_MIN_MATCH_SCORE=60

# ============================================================================
# COMMUNICATION HUB CONFIGURATION
# ============================================================================

COMM_HUB_ENABLED=true
COMM_DEFAULT_CHANNEL=email
COMM_DND_ENFORCEMENT=true
COMM_FREQUENCY_CAP_DAILY=5
COMM_FREQUENCY_CAP_WEEKLY=15

# Module 11 Integration
MODULE_11_URL=http://module-11-communication:3011
MODULE_11_API_KEY=your_api_key_here
MODULE_11_TIMEOUT=10000

# ============================================================================
# CUSTOMER SUCCESS CONFIGURATION
# ============================================================================

# Churn Prediction
CHURN_PREDICTION_ENABLED=true
CHURN_HIGH_RISK_THRESHOLD=0.7
CHURN_CRITICAL_RISK_THRESHOLD=0.85

# Automated Playbooks
PLAYBOOKS_ENABLED=true
PLAYBOOKS_AUTO_EXECUTE=true
PLAYBOOKS_CSM_ASSIGNMENT_ENABLED=true

# Product Usage Analytics
USAGE_TRACKING_ENABLED=true
USAGE_ENGAGEMENT_THRESHOLD=70
USAGE_ADOPTION_THRESHOLD=60

# Expansion Opportunities
EXPANSION_ENGINE_ENABLED=true
EXPANSION_MIN_HEALTH_SCORE=70
EXPANSION_AUTO_CAMPAIGNS=true

# Feedback & NPS
NPS_SURVEY_FREQUENCY=quarterly
NPS_DETRACTOR_ALERT_THRESHOLD=6
NPS_PROMOTER_REQUEST_THRESHOLD=9

# ============================================================================
# CROSS-MODULE INTEGRATION
# ============================================================================

# Module URLs
MODULE_01_URL=http://module-01-invoice:3001
MODULE_03_URL=http://module-03-payment:3003
MODULE_04_URL=http://module-04-analytics:3004
MODULE_06_URL=http://module-06-credit:3006
MODULE_08_URL=http://module-08-dispute:3008

# Event Listeners
EVENT_LISTENER_INVOICE_CREATED=true
EVENT_LISTENER_PAYMENT_RECEIVED=true
EVENT_LISTENER_DISPUTE_RESOLVED=true
EVENT_LISTENER_MILESTONE_ACHIEVED=true

# ============================================================================
# MONITORING & LOGGING
# ============================================================================

LOG_LEVEL=info
LOG_FORMAT=json

# Metrics
METRICS_ENABLED=true
METRICS_PORT=9090
METRICS_PATH=/metrics

# Health Checks
HEALTH_CHECK_ENABLED=true
HEALTH_CHECK_PATH=/health
HEALTH_CHECK_INTERVAL=30000  # 30 seconds

# APM
APM_ENABLED=true
APM_SERVICE_NAME=module-09-prod
APM_SERVER_URL=http://apm-server:8200

# ============================================================================
# PERFORMANCE & SCALING
# ============================================================================

# Workers
WORKER_THREADS=4
EVENT_QUEUE_CONCURRENCY=10

# Caching
CACHE_ENABLED=true
CACHE_BENCHMARK_TTL=3600
CACHE_ANALYTICS_TTL=300

# Rate Limiting
RATE_LIMIT_ENABLED=true
RATE_LIMIT_WINDOW=60000  # 1 minute
RATE_LIMIT_MAX_REQUESTS=100

# ============================================================================
# SECURITY
# ============================================================================

JWT_SECRET=your_jwt_secret_here
JWT_EXPIRATION=3600

CORS_ENABLED=true
CORS_ORIGINS=https://app.platform.com,https://admin.platform.com

API_KEY_VALIDATION=true
ENCRYPT_SENSITIVE_DATA=true

# ============================================================================
# FEATURE FLAGS
# ============================================================================

# Gradual Rollout
FEATURE_NETWORK_INTEL_ROLLOUT=100  # 100% enabled
FEATURE_VIRAL_WORKFLOWS_ROLLOUT=100
FEATURE_COMMUNITY_ROLLOUT=100
FEATURE_REFERRAL_ENGINE_ROLLOUT=100
FEATURE_ML_PREDICTIONS_ROLLOUT=80  # 80% of users

# A/B Testing
AB_TEST_VIRAL_UI_ENABLED=true
AB_TEST_REFERRAL_REWARDS_ENABLED=true

# ============================================================================
# DATA RETENTION
# ============================================================================

NETWORK_EVENT_RETENTION_DAYS=730  # 2 years
VIRAL_OPPORTUNITY_RETENTION_DAYS=90
COMMUNITY_POST_RETENTION_DAYS=1825  # 5 years
REFERRAL_DATA_RETENTION_DAYS=1095  # 3 years
